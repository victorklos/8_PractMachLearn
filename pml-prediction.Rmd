---
title: "PML Prediction"
author: "Victor Klos"
date: "13-03-2015"
output: html_document
---

TODO introduction 


## Loading and cleaning the data

The data is already split into a training and testing set. The format is `csv` which is readily handled by R (even though the extraneous quotes require a bit of a detour). Running a `summary` on the training set reveals that many columns contain the phrase `#DIV/0!`, so the data suffers from an export problem. Also, the column names are not 'tidy' as they contain underscores.

Knowing this, loading and tidying becomes:

```{r}
nas <- c("", "\"\"", "NA", "#DIV/0!")
training <- read.csv("pml-training.csv", colClasses="character", na.strings=nas)
testing <- read.csv("pml-testing.csv", colClasses="character", na.strings=nas)
colnames(training) <- colnames(testing) <- tolower(gsub("_", ".", colnames(training)))

classes <- c("integer", rep("factor", 5), rep("numeric", 153), "factor")
for (i in 1:ncol(training)) {
  training[,i] <- do.call(paste("as", classes[i], sep="."), list(training[,i]))
}
```

Both the testing and training set have `r dim(training)[2]` columns. The training set contains `r dim(training)[1]` rows and the testing set has `r dim(testing)[1]` rows.


## Exploratory analysis

From looking at the summary it was obvious that many columns in the training dataset suffer from missing values. Let's examine the extent of this potential problem:

```{r}
nas.per.col <- apply(training, 2, FUN=function(col) sum(is.na(col)))
table(nas.per.col)
```

This overview tells us that _(i)_ NA's are abundant and _(ii)_ there is no fixing them as there exist no columns with only a few missing values. Hence, all columns with NA's will be removed from the dataset.

Additionally, the rows with the index, user name, time stamps and window information will not aid in building a good predictor so these are removed too:

```{r}
cols.to.remove <- c(1:6, which(nas.per.col > 0))
training <- training[-cols.to.remove]
testing <- testing[-cols.to.remove]
```

Next, we can check if the remaining data isn't near zero or without variance:

```{r, message=F}
library(caret)
nz <- nearZeroVar(training, saveMetrics=T)
sum(nz$zeroVar) + sum(nz$nzv)
```

Zero columns in the danger zone; all data in the current training set is meant to be. Let's move on to building some predictors...



## Appendix: Training data summary

```{r, echo=F}
summary(training$classe)
```

## Next

```{r, echo=F}
summary(training)
```

